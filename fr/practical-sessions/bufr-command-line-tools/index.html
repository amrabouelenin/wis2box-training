
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://training.wis2box.wis.wmo.int/fr/practical-sessions/bufr-command-line-tools/">
      
      
        <link rel="prev" href="../automating-data-ingestion/">
      
      
        <link rel="next" href="../configuring-station-metadata/">
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Travailler avec des données BUFR - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#travailler-avec-des-donnees-bufr" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../" title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Travailler avec des données BUFR
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Sélectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../es/practical-sessions/bufr-command-line-tools/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../zh/practical-sessions/bufr-command-line-tools/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ru/practical-sessions/bufr-command-line-tools/" hreflang="ru" class="md-select__link">
              Русский
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ar/practical-sessions/bufr-command-line-tools/" hreflang="ar" class="md-select__link">
              العربية
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Aide-mémoire
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Aide-mémoire
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WIS2 in a box cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modèles csv2bufr
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modèles csv2bufr
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/aws-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèle AWS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/daycli-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèle DAYCLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sessions pratiques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Sessions pratiques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-to-wis2-over-mqtt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connexion à WIS2 via MQTT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-your-student-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accéder à votre VM étudiant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../initializing-wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initialisation de wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-wis2box-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration des jeux de données dans wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-station-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration des métadonnées des stations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ingesting-data-for-publication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ingestion de données pour publication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-conversion-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outils de conversion de données
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../csv2bufr-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèles de mappage de CSV à BUFR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding-gts-headers-to-wis2-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ajout d'en-têtes GTS aux notifications WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets-with-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration d'un ensemble de données recommandé avec contrôle d'accès
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../downloading-data-from-wis2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Téléchargement et décodage des données depuis WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discovering-datasets-from-wis2-gdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Découverte de jeux de données depuis le Catalogue de Découverte Global WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Préparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilisation-des-outils-en-ligne-de-commande-bufr" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation des outils en ligne de commande BUFR
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilisation des outils en ligne de commande BUFR">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercice-1-bufr_ls" class="md-nav__link">
    <span class="md-ellipsis">
      Exercice 1 - bufr_ls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercice-2-bufr_dump" class="md-nav__link">
    <span class="md-ellipsis">
      Exercice 2 - bufr_dump
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercice-3-fichiers-de-mappage-csv2bufr" class="md-nav__link">
    <span class="md-ellipsis">
      Exercice 3 - fichiers de mappage csv2bufr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="travailler-avec-des-donnees-bufr">Travailler avec des données BUFR</h1>
<div class="admonition abstract">
<p class="admonition-title">Résultats d'apprentissage</p>
<p>Dans cette session pratique, vous serez initié à certains outils BUFR inclus dans le conteneur <strong>wis2box-api</strong> qui sont utilisés pour transformer des données au format BUFR et pour lire le contenu encodé en BUFR.</p>
<p>Vous apprendrez :</p>
<ul>
<li>comment inspecter les en-têtes dans le fichier BUFR en utilisant la commande <code>bufr_ls</code></li>
<li>comment extraire et inspecter les données dans un fichier bufr en utilisant <code>bufr_dump</code></li>
<li>la structure de base des modèles bufr utilisés dans csv2bufr et comment utiliser l'outil en ligne de commande</li>
<li>et comment apporter des modifications de base aux modèles bufr et comment mettre à jour le wis2box pour utiliser la version révisée</li>
</ul>
</div>
<h2 id="introduction">Introduction</h2>
<p>Les plugins qui produisent des notifications avec des données BUFR utilisent des processus dans le wis2box-api pour travailler avec des données BUFR, par exemple pour transformer les données de CSV en BUFR ou de BUFR en geojson.</p>
<p>Le conteneur wis2box-api comprend un certain nombre d'outils pour travailler avec des données BUFR.</p>
<p>Ces outils incluent ceux développés par l'ECMWF et inclus dans le logiciel ecCodes, plus d'informations à ce sujet peuvent être trouvées sur le <a href="https://confluence.ecmwf.int/display/ECC/BUFR+tools">site web ecCodes</a>.</p>
<p>Dans cette session, vous serez initié aux commandes <code>bufr_ls</code> et <code>bufr_dump</code> du paquet logiciel ecCodes et à la configuration avancée de l'outil csv2bufr.</p>
<h2 id="preparation">Préparation</h2>
<p>Pour utiliser les outils en ligne de commande BUFR, vous devrez être connecté au conteneur wis2box-api et à moins d'indication contraire, toutes les commandes doivent être exécutées sur ce conteneur. Vous devrez également avoir MQTT Explorer ouvert et connecté à votre courtier.</p>
<p>Connectez-vous d'abord à votre VM étudiant via votre client ssh, puis connectez-vous au conteneur wis2box-api :</p>
<div class="highlight"><pre><span></span><code>cd ~/wis2box-1.0.0rc1
python3 wis2box-ctl.py login wis2box-api
</code></pre></div>
<p>Confirmez que les outils sont disponibles, en commençant par ecCodes :</p>
<p><div class="highlight"><pre><span></span><code>bufr_dump -V
</code></pre></div>
Vous devriez obtenir la réponse suivante :</p>
<div class="highlight"><pre><span></span><code>ecCodes Version 2.28.0
</code></pre></div>
<p>Ensuite, vérifiez csv2bufr :</p>
<div class="highlight"><pre><span></span><code>csv2bufr --version
</code></pre></div>
<p>Vous devriez obtenir la réponse suivante :</p>
<div class="highlight"><pre><span></span><code>csv2bufr, version 0.7.4
</code></pre></div>
<p>Enfin, créez un répertoire de travail pour travailler :</p>
<div class="highlight"><pre><span></span><code>cd /data/wis2box
mkdir -p working/bufr-cli
cd working/bufr-cli
</code></pre></div>
<p>Vous êtes maintenant prêt à commencer à utiliser les outils BUFR.</p>
<h2 id="utilisation-des-outils-en-ligne-de-commande-bufr">Utilisation des outils en ligne de commande BUFR</h2>
<h3 id="exercice-1-bufr_ls">Exercice 1 - bufr_ls</h3>
<p>Dans ce premier exercice, vous utiliserez la commande <code>bufr_ls</code> pour inspecter les en-têtes d'un fichier BUFR et pour déterminer le contenu du fichier. Les en-têtes suivants sont inclus dans un fichier BUFR :</p>
<table>
<thead>
<tr>
<th>en-tête</th>
<th>clé ecCodes</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>centre d'origine/génération</td>
<td>centre</td>
<td>Le centre d'origine / de génération des données</td>
</tr>
<tr>
<td>sous-centre d'origine/génération</td>
<td>bufrHeaderSubCentre</td>
<td>Le sous-centre d'origine / de génération des données</td>
</tr>
<tr>
<td>Numéro de séquence de mise à jour</td>
<td>updateSequenceNumber</td>
<td>S'il s'agit de la première version des données (0) ou d'une mise à jour (&gt;0)</td>
</tr>
<tr>
<td>Catégorie de données</td>
<td>dataCategory</td>
<td>Le type de données contenu dans le message BUFR, par ex. données de surface. Voir <a href="https://github.com/wmo-im/BUFR4/blob/master/BUFR_TableA_en.csv">Table A BUFR</a></td>
</tr>
<tr>
<td>Sous-catégorie de données internationales</td>
<td>internationalDataSubCategory</td>
<td>Le sous-type de données contenu dans le message BUFR, par ex. données de surface. Voir <a href="https://github.com/wmo-im/CCT/blob/master/C13.csv">Tableau des codes communs C-13</a></td>
</tr>
<tr>
<td>Année</td>
<td>typicalYear (typicalDate)</td>
<td>Moment le plus typique pour le contenu du message BUFR</td>
</tr>
<tr>
<td>Mois</td>
<td>typicalMonth (typicalDate)</td>
<td>Moment le plus typique pour le contenu du message BUFR</td>
</tr>
<tr>
<td>Jour</td>
<td>typicalDay (typicalDate)</td>
<td>Moment le plus typique pour le contenu du message BUFR</td>
</tr>
<tr>
<td>Heure</td>
<td>typicalHour (typicalTime)</td>
<td>Moment le plus typique pour le contenu du message BUFR</td>
</tr>
<tr>
<td>Minute</td>
<td>typicalMinute (typicalTime)</td>
<td>Moment le plus typique pour le contenu du message BUFR</td>
</tr>
<tr>
<td>Descripteurs BUFR</td>
<td>unexpandedDescriptors</td>
<td>Liste d'un ou plusieurs descripteurs BUFR définissant les données contenues dans le fichier</td>
</tr>
</tbody>
</table>
<p>Téléchargez le fichier exemple directement dans le conteneur de gestion wis2box en utilisant la commande suivante :</p>
<div class="highlight"><pre><span></span><code>curl https://training.wis2box.wis.wmo.int/sample-data/bufr-cli-ex1.bufr4 --output bufr-cli-ex1.bufr4
</code></pre></div>
<p>Utilisez maintenant la commande suivante pour exécuter <code>bufr_ls</code> sur ce fichier :</p>
<div class="highlight"><pre><span></span><code>bufr_ls<span class="w"> </span>bufr-cli-ex1.bufr4
</code></pre></div>
<p>Vous devriez voir la sortie suivante :</p>
<div class="highlight"><pre><span></span><code>bufr-cli-ex1.bufr4
centre<span class="w">                     </span>masterTablesVersionNumber<span class="w">  </span>localTablesVersionNumber<span class="w">   </span>typicalDate<span class="w">                </span>typicalTime<span class="w">                </span>numberOfSubsets
cnmc<span class="w">                       </span><span class="m">29</span><span class="w">                         </span><span class="m">0</span><span class="w">                          </span><span class="m">20231002</span><span class="w">                   </span><span class="m">000000</span><span class="w">                     </span><span class="m">1</span>
<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span>bufr-cli-ex1.bufr4

<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>total<span class="w"> </span>messages<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>files
</code></pre></div>
<p>Par elle-même, cette information n'est pas très informative, avec seulement des informations limitées sur le contenu du fichier fournies.</p>
<p>La sortie par défaut ne fournit pas d'informations sur le type d'observation ou de données et est dans un format qui n'est pas très facile à lire. Cependant, diverses options peuvent être passées à <code>bufr_ls</code> pour changer à la fois le format et les champs d'en-tête imprimés.</p>
<p>Utilisez <code>bufr_ls</code> sans aucun argument pour voir les options :</p>
<div class="highlight"><pre><span></span><code>bufr_ls
</code></pre></div>
<p>Vous devriez voir la sortie suivante :</p>
<div class="highlight"><pre><span></span><code>NAME    bufr_ls

DESCRIPTION
        List content of BUFR files printing values of some header keys.
        Only scalar keys can be printed.
        It does not fail when a key is not found.

USAGE
        bufr_ls [options] bufr_file bufr_file ...

OPTIONS
        -p key[:{s|d|i}],key[:{s|d|i}],...
                Declaration of keys to print.
                For each key a string (key:s), a double (key:d) or an integer (key:i)
                type can be requested. Default type is string.
        -F format
                C style format for floating-point values.
        -P key[:{s|d|i}],key[:{s|d|i}],...
                As -p adding the declared keys to the default list.
        -w key[:{s|d|i}]{=|!=}value,key[:{s|d|i}]{=|!=}value,...
                Where clause.
                Messages are processed only if they match all the key/value constraints.
                A valid constraint is of type key=value or key!=value.
                For each key a string (key:s), a double (key:d) or an integer (key:i)
                type can be specified. Default type is string.
                In the value you can also use the forward-slash character &#39;/&#39; to specify an OR condition (i.e. a logical disjunction)
                Note: only one -w clause is allowed.
        -j      JSON output
        -s key[:{s|d|i}]=value,key[:{s|d|i}]=value,...
                Key/values to set.
                For each key a string (key:s), a double (key:d) or an integer (key:i)
                type can be defined. By default the native type is set.
        -n namespace
                All the keys belonging to the given namespace are printed.
        -m      Mars keys are printed.
        -V      Version.
        -W width
                Minimum width of each column in output. Default is 10.
        -g      Copy GTS header.
        -7      Does not fail when the message has wrong length

SEE ALSO
        Full documentation and examples at:
        &lt;https://confluence.ecmwf.int/display/ECC/bufr_ls&gt;
</code></pre></div>
<p>Exécutez maintenant la même commande sur le fichier exemple mais affichez les informations au format JSON.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Quel indicateur passez-vous à la commande <code>bufr_ls</code> pour voir la sortie au format JSON ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Vous pouvez changer le format de sortie en json en utilisant l'indicateur <code>-j</code>, c'est-à-dire
<code>bufr_ls -j &lt;fichier-entrée&gt;</code>. Cela peut être plus lisible que le format de sortie par défaut. Voir la sortie d'exemple ci-dessous :</p>
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;centre&quot;: &quot;cnmc&quot;,
    &quot;masterTablesVersionNumber&quot;: 29,
    &quot;localTablesVersionNumber&quot;: 0,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;,
    &quot;numberOfSubsets&quot;: 1
  }
]}
</code></pre></div>
</details>
<p>Lors de l'examen d'un fichier BUFR, nous voulons souvent déterminer le type de données contenu dans le fichier et la date / heure typiques des données dans le fichier. Ces informations peuvent être listées en utilisant l'indicateur <code>-p</code> pour sélectionner les en-têtes à afficher. Plusieurs en-têtes peuvent être inclus en utilisant une liste séparée par des virgules.</p>
<p>En utilisant la commande <code>bufr_ls</code>, inspectez le fichier de test et identifiez le type de données contenu dans le fichier et la date et l'heure typiques pour ces données.</p>
<details class="hint">
<summary>Hint</summary>
<p>Les clés ecCodes sont données dans le tableau ci-dessus. Nous pouvons utiliser ce qui suit pour lister la dataCategory et
internationalDataSubCategory des données BUFR :</p>
<div class="highlight"><pre><span></span><code>bufr_ls -p dataCategory,internationalDataSubCategory bufr-cli-ex1.bufr4
</code></pre></div>
<p>Des clés supplémentaires peuvent être ajoutées si nécessaire.</p>
</details>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Quel type de données (catégorie de données et sous-catégorie) sont contenues dans le fichier ? Quelle est la date et l'heure typiques pour les données ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>La commande que vous devez exécuter aurait dû être similaire à :</p>
<div class="highlight"><pre><span></span><code>bufr_ls -p dataCategory,internationalDataSubCategory,typicalDate,typicalTime -j bufr-cli-ex1.bufr4
</code></pre></div>
<p>Vous avez peut-être ajouté des clés supplémentaires, ou listé l'année, le mois, le jour, etc. individuellement. La sortie devrait
être similaire à ci-dessous, selon que vous avez sélectionné le format JSON ou la sortie par défaut.</p>
<div class="highlight"><pre><span></span><code>{ &quot;messages&quot; : [
  {
    &quot;dataCategory&quot;: 2,
    &quot;internationalDataSubCategory&quot;: 4,
    &quot;typicalDate&quot;: 20231002,
    &quot;typicalTime&quot;: &quot;000000&quot;
  }
]}
</code></pre></div>
<p>À partir de cela, nous voyons que :</p>
<ul>
<li>La catégorie de données est 2, à partir de <a href="https://github.com/wmo-im/BUFR4/blob/master/BUFR_TableA_en.csv">Table A BUFR</a>
  nous pouvons voir que ce fichier contient des données "Sondages verticaux (autres que par satellite)".</li>
<li>La sous-catégorie internationale est 4, indiquant
  "Rapports de température/humidité/vent de niveau supérieur provenant de stations terrestres fixes (TEMP)" données. Cette information peut être consultée
  dans <a href="https://github.com/wmo-im/CCT/blob/master/C13.csv">Tableau des codes communs C-13</a> (ligne 33). Notez la combinaison
  de catégorie et de sous-catégorie.</li>
<li>La date et l'heure typiques sont 2023/10/02 et 00:00:00z respectivement.</li>
</ul>
</details>
<h3 id="exercice-2-bufr_dump">Exercice 2 - bufr_dump</h3>
<p>La commande <code>bufr_dump</code> peut être utilisée pour lister et examiner le contenu d'un fichier BUFR, y compris les données elles-mêmes.</p>
<p>Dans cet exercice, nous utiliserons un fichier BUFR qui est le même que celui que vous avez créé lors de la session pratique initiale csv2bufr en utilisant le wis2box-webapp.</p>
<p>Téléchargez le fichier exemple directement dans le conteneur de gestion wis2box avec la commande suivante :</p>
<div class="highlight"><pre><span></span><code>curl https://training.wis2box.wis.wmo.int/sample-data/bufr-cli-ex2.bufr4 --output bufr-cli-ex2.bufr4
</code></pre></div>
<p>Exécutez maintenant la commande <code>bufr_dump</code> sur le fichier, en utilisant l'indicateur <code>-p</code> pour afficher les données au format texte brut (format clé=valeur) :</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4
</code></pre></div>
<p>Vous devriez voir environ 240 clés affichées, dont beaucoup sont manquantes. Cela est typique avec les données du monde réel car toutes les clés eccodes ne sont pas peuplées avec des données signalées.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Les valeurs manquantes peuvent être filtrées à l'aide d'outils tels que <code>grep</code> :
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4 | grep -v MISSING
</code></pre></div></p>
</div>
<p>Le fichier BUFR exemple pour cet exercice provient de la session pratique csv2bufr. Veuillez télécharger le fichier CSV original dans votre emplacement actuel comme suit :</p>
<div class="highlight"><pre><span></span><code>curl https://training.wis2box.wis.wmo.int/sample-data/csv2bufr-ex1.csv --output csv2bufr-ex1.csv
</code></pre></div>
<p>Et affichez le contenu du fichier avec :</p>
<div class="highlight"><pre><span></span><code>more csv2bufr-ex1.csv
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Utilisez la commande suivante pour afficher la colonne 18 dans le fichier CSV et vous trouverez la pression moyenne au niveau de la mer signalée (msl_pressure) :</p>
<div class="highlight"><pre><span></span><code>more csv2bufr-ex1.csv | cut -d &#39;,&#39; -f 18
</code></pre></div>
<p>Quelle clé dans la sortie BUFR correspond à la pression moyenne au niveau de la mer ?</p>
</div>
<details class="hint">
<summary>Hint</summary>
<p>Des outils tels que <code>grep</code> peuvent être utilisés en combinaison avec <code>bufr_dump</code>. Par exemple :</p>
<div class="highlight"><pre><span></span><code>bufr_dump -p bufr-cli-ex2.bufr4 | grep -i &quot;pressure&quot;
</code></pre></div>
<p>filtrerait le contenu de <code>bufr_dump</code> pour ne montrer que les lignes contenant le mot pression. Alternativement,
la sortie pourrait être filtrée sur une valeur.</p>
</details>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>La clé "pressureReducedToMeanSeaLevel" correspond à la colonne msl_pressure dans le fichier CSV d'entrée.</p>
</details>
<p>Passez quelques minutes à examiner le reste de la sortie, en la comparant au fichier CSV d'entrée avant de passer à l'exercice suivant. Par exemple, vous pouvez essayer de trouver les clés dans la sortie BUFR qui correspondent à l'humidité relative (colonne 23 dans le fichier CSV) et à la température de l'air (colonne 21 dans le fichier CSV).</p>
<h3 id="exercice-3-fichiers-de-mappage-csv2bufr">Exercice 3 - fichiers de mappage csv2bufr</h3>
<p>L'outil csv2bufr peut être configuré pour traiter des données tabulaires avec différentes colonnes et séquences BUFR.</p>
<p>Cela se fait par le biais d'un fichier de configuration écrit au format JSON.</p>
<p>Comme les données BUFR elles-mêmes, le fichier JSON contient une section d'en-tête et une section de données, qui correspondent largement aux mêmes sections dans BUFR.</p>
<p>De plus, certaines options de formatage sont spécifiées dans le fichier JSON.</p>
<p>Le fichier JSON pour le mappage par défaut peut être consulté via le lien ci-dessous (clic droit et ouvrir dans un nouvel onglet) :</p>
<p><a href="https://raw.githubusercontent.com/wmo-im/csv2bufr/main/csv2bufr/templates/resources/aws-template.json">aws-template.json</a></p>
<p>Examinez la section <code>header</code> du fichier de mappage (montrée ci-dessous) et comparez-la au tableau de l'exercice 1 (colonne clé ecCodes) :</p>
<p>```
"header":[
    {"eccodes_key": "edition", "value": "const:4"},
    {"eccodes_key": "masterTableNumber", "value": "const:0"},
    {"eccodes_key": "bufrHeaderCentre", "value": "const:0"},
    {"eccodes_key": "bufrHeaderSubCentre", "value": "const:0"},
    {"eccodes_key": "updateSequenceNumber", "value": "const:0"},
    {"eccodes_key": "dataCategory", "value": "const:0"},
    {"eccodes_key": "internationalDataSubCategory", "value": "const:2"},
    {"eccodes_key": "masterTablesVersionNumber", "value": "const:30"},
    {"eccodes_key": "numberOfSubsets", "value": "const:1"},
    {"eccodes_key": "obs</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../../assets/js/disclaimer.js"></script>
      
    
  </body>
</html>