
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="WIS2 in a box (wis2box) is a Free and Open Source (FOSS) Reference Implementation of a WMO WIS2 Node. The project provides a plug and play toolset to ingest, process, and publish weather/climate/water data using standards-based approaches in alignment with the WIS2 principles. wis2box also provides access to all data in the WIS2 network. wis2box is designed to have a low barrier to entry for data providers, providing enabling infrastructure and services for data discovery, access, and visualization.">
      
      
        <meta name="author" content="World Meteorological Organization">
      
      
        <link rel="canonical" href="https://training.wis2box.wis.wmo.int/fr/practical-sessions/ingesting-data-for-publication/">
      
      
        <link rel="prev" href="../configuring-station-metadata/">
      
      
        <link rel="next" href="../data-conversion-tools/">
      
      
      <link rel="icon" href="https://public.wmo.int/sites/all/themes/wmo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Ingestion de données pour publication - WIS2 in a box training</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/css/custom.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ingestion-de-donnees-pour-publication" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href="../../" title="WIS2 in a box training" class="md-header__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WIS2 in a box training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ingestion de données pour publication
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Sélectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../practical-sessions/ingesting-data-for-publication/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="fr" class="md-select__link">
              Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../es/practical-sessions/ingesting-data-for-publication/" hreflang="es" class="md-select__link">
              Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../zh/practical-sessions/ingesting-data-for-publication/" hreflang="zh" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ru/practical-sessions/ingesting-data-for-publication/" hreflang="ru" class="md-select__link">
              Русский
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../ar/practical-sessions/ingesting-data-for-publication/" hreflang="ar" class="md-select__link">
              العربية
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="WIS2 in a box training" class="md-nav__button md-logo" aria-label="WIS2 in a box training" data-md-component="logo">
      
  <img src="../../../assets/img/wmo-logo.png" alt="logo">

    </a>
    WIS2 in a box training
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Aide-mémoire
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Aide-mémoire
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cheatsheets/wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WIS2 in a box cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modèles csv2bufr
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modèles csv2bufr
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/aws-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèle AWS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../csv2bufr-templates/daycli-template/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèle DAYCLI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sessions pratiques
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Sessions pratiques
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../connecting-to-wis2-over-mqtt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Connexion à WIS2 via MQTT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accessing-your-student-vm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accéder à votre VM étudiant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../initializing-wis2box/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initialisation de wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-wis2box-datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration des jeux de données dans wis2box
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-station-metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration des métadonnées des stations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Ingestion de données pour publication
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Ingestion de données pour publication
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Préparation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Préparation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparer-les-donnees-dexemple" class="md-nav__link">
    <span class="md-ellipsis">
      Préparer les données d'exemple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajouter-la-station-de-test" class="md-nav__link">
    <span class="md-ellipsis">
      Ajouter la station de test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tester-lingestion-de-donnees-depuis-la-ligne-de-commande" class="md-nav__link">
    <span class="md-ellipsis">
      Tester l'ingestion de données depuis la ligne de commande
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telechargement-de-donnees-a-laide-de-linterface-web-minio" class="md-nav__link">
    <span class="md-ellipsis">
      Téléchargement de données à l'aide de l'interface web MinIO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telechargement-de-donnees-a-laide-de-sftp" class="md-nav__link">
    <span class="md-ellipsis">
      Téléchargement de données à l'aide de SFTP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#televersement-de-donnees-a-laide-dun-script-python" class="md-nav__link">
    <span class="md-ellipsis">
      Téléversement de données à l'aide d'un script Python
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-conversion-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Outils de conversion de données
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../csv2bufr-templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modèles de mappage de CSV à BUFR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adding-gts-headers-to-wis2-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ajout d'en-têtes GTS aux notifications WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets-with-access-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration d'un ensemble de données recommandé avec contrôle d'accès
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../downloading-data-from-wis2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Téléchargement et décodage des données depuis WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discovering-datasets-from-wis2-gdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Découverte de jeux de données depuis le Catalogue de Découverte Global WIS2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Préparation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Préparation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparer-les-donnees-dexemple" class="md-nav__link">
    <span class="md-ellipsis">
      Préparer les données d'exemple
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajouter-la-station-de-test" class="md-nav__link">
    <span class="md-ellipsis">
      Ajouter la station de test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tester-lingestion-de-donnees-depuis-la-ligne-de-commande" class="md-nav__link">
    <span class="md-ellipsis">
      Tester l'ingestion de données depuis la ligne de commande
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telechargement-de-donnees-a-laide-de-linterface-web-minio" class="md-nav__link">
    <span class="md-ellipsis">
      Téléchargement de données à l'aide de l'interface web MinIO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#telechargement-de-donnees-a-laide-de-sftp" class="md-nav__link">
    <span class="md-ellipsis">
      Téléchargement de données à l'aide de SFTP
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#televersement-de-donnees-a-laide-dun-script-python" class="md-nav__link">
    <span class="md-ellipsis">
      Téléversement de données à l'aide d'un script Python
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="ingestion-de-donnees-pour-publication">Ingestion de données pour publication</h1>
<div class="admonition abstract">
<p class="admonition-title">Résultats d'apprentissage</p>
<p>À la fin de cette session pratique, vous serez capable de :</p>
<ul>
<li>Déclencher le flux de travail wis2box en téléchargeant des données sur MinIO en utilisant la ligne de commande, l'interface web de MinIO, SFTP ou un script Python.</li>
<li>Accéder au tableau de bord Grafana pour surveiller le statut de l'ingestion des données et consulter les journaux de votre instance wis2box.</li>
<li>Voir les notifications de données WIS2 publiées par votre wis2box en utilisant MQTT Explorer.</li>
</ul>
</div>
<h2 id="introduction">Introduction</h2>
<p>Dans WIS2, les données sont partagées en temps réel en utilisant des notifications de données WIS2 qui contiennent un lien "canonique" à partir duquel les données peuvent être téléchargées.</p>
<p>Pour déclencher le flux de travail des données dans un WIS2 Node en utilisant le logiciel wis2box, les données doivent être téléchargées dans le bucket <strong>wis2box-incoming</strong> sur <strong>MinIO</strong>, ce qui initie le flux de travail wis2box. Ce processus aboutit à la publication des données via une notification de données WIS2. Selon les mappages de données configurés dans votre instance wis2box, les données peuvent être transformées au format BUFR avant d'être publiées.</p>
<p>Dans cet exercice, nous utiliserons des fichiers de données exemples pour déclencher le flux de travail wis2box et <strong>publier des notifications de données WIS2</strong> pour l'ensemble de données que vous avez configuré lors de la session pratique précédente.</p>
<p>Pendant l'exercice, nous surveillerons le statut de l'ingestion des données en utilisant le <strong>tableau de bord Grafana</strong> et <strong>MQTT Explorer</strong>. Le tableau de bord Grafana utilise des données de Prometheus et Loki pour afficher le statut de votre wis2box, tandis que MQTT Explorer vous permet de voir les notifications de données WIS2 publiées par votre instance wis2box.</p>
<p>Notez que wis2box transformera les données d'exemple en format BUFR avant de les publier sur le courtier MQTT, conformément aux mappages de données préconfigurés dans votre ensemble de données. Pour cet exercice, nous nous concentrerons sur les différentes méthodes pour télécharger des données sur votre instance wis2box et vérifier l'ingestion et la publication réussies. La transformation des données sera abordée plus tard dans la session pratique <a href="./data-conversion-tools">Outils de conversion de données</a>.</p>
<h2 id="preparation">Préparation</h2>
<p>Cette section utilise l'ensemble de données pour "surface-based-observations/synop" précédemment créé dans la session pratique <a href="./configuring-wis2box-datasets">Configuration des ensembles de données dans wis2box</a>. Elle nécessite également une connaissance de la configuration des stations dans le <strong>wis2box-webapp</strong>, comme décrit dans la session pratique <a href="./configuring-station-metadata">Configuration des métadonnées des stations</a>.</p>
<p>Assurez-vous de pouvoir vous connecter à votre VM étudiante en utilisant votre client SSH (par exemple, PuTTY).</p>
<p>Assurez-vous que wis2box est opérationnel :</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box/
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>start
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>status
</code></pre></div>
<p>Assurez-vous que MQTT Explorer est en cours d'exécution et connecté à votre instance en utilisant les identifiants publics <code>everyone/everyone</code> avec un abonnement au sujet <code>origin/a/wis2/#</code>.</p>
<p>Assurez-vous que vous avez un navigateur web ouvert avec le tableau de bord Grafana pour votre instance en naviguant vers <code>http://YOUR-HOST:3000</code>.</p>
<h3 id="preparer-les-donnees-dexemple">Préparer les données d'exemple</h3>
<p>Copiez le répertoire <code>exercise-materials/data-ingest-exercises</code> dans le répertoire que vous avez défini comme <code>WIS2BOX_HOST_DATADIR</code> dans votre fichier <code>wis2box.env</code> :</p>
<div class="highlight"><pre><span></span><code>cp<span class="w"> </span>-r<span class="w"> </span>~/exercise-materials/data-ingest-exercises<span class="w"> </span>~/wis2box-data/
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Le <code>WIS2BOX_HOST_DATADIR</code> est monté comme <code>/data/wis2box/</code> à l'intérieur du conteneur wis2box-management par le fichier <code>docker-compose.yml</code> inclus dans le répertoire <code>wis2box</code>.</p>
<p>Cela vous permet de partager des données entre l'hôte et le conteneur.</p>
</div>
<h3 id="ajouter-la-station-de-test">Ajouter la station de test</h3>
<p>Ajoutez la station avec l'identifiant WIGOS <code>0-20000-0-64400</code> à votre instance wis2box en utilisant l'éditeur de stations dans le wis2box-webapp.</p>
<p>Récupérez la station depuis OSCAR :</p>
<p><img alt="oscar-station" src="/../assets/img/webapp-test-station-oscar-search.png" width="600"></p>
<p>Ajoutez la station aux ensembles de données que vous avez créés pour la publication sur "../surface-based-observations/synop" et enregistrez les modifications en utilisant votre jeton d'authentification :</p>
<p><img alt="webapp-test-station" src="/../assets/img/webapp-test-station-save.png" width="800"></p>
<p>Notez que vous pouvez retirer cette station de votre ensemble de données après la session pratique.</p>
<h2 id="tester-lingestion-de-donnees-depuis-la-ligne-de-commande">Tester l'ingestion de données depuis la ligne de commande</h2>
<p>Dans cet exercice, nous utiliserons la commande <code>wis2box data ingest</code> pour télécharger des données sur MinIO.</p>
<p>Assurez-vous d'être dans le répertoire <code>wis2box</code> et connectez-vous au conteneur <strong>wis2box-management</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box
python3<span class="w"> </span>wis2box-ctl.py<span class="w"> </span>login
</code></pre></div>
<p>Vérifiez que les données d'échantillon suivantes sont disponibles dans le répertoire <code>/data/wis2box/</code> à l'intérieur du conteneur <strong>wis2box-management</strong> :</p>
<div class="highlight"><pre><span></span><code>ls<span class="w"> </span>-lh<span class="w"> </span>/data/wis2box/data-ingest-exercises/synop_202412030900.txt
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">Ingestion de données en utilisant <code>wis2box data ingest</code></p>
<p>Exécutez la commande suivante pour ingérer le fichier de données d'échantillon dans votre instance wis2box :</p>
<div class="highlight"><pre><span></span><code>wis2box<span class="w"> </span>data<span class="w"> </span>ingest<span class="w"> </span>-p<span class="w"> </span>/data/wis2box/data-ingest-exercises/synop_202412030900.txt<span class="w"> </span>--metadata-id<span class="w"> </span>urn:wmo:md:not-my-centre:synop-test
</code></pre></div>
<p>Les données ont-elles été ingérées avec succès ? Sinon, quel était le message d'erreur et comment pouvez-vous le corriger ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Les données n'ont <strong>pas</strong> été ingérées avec succès. Vous devriez voir ce qui suit :</p>
<div class="highlight"><pre><span></span><code>Error:<span class="w"> </span><span class="nv">metadata_id</span><span class="o">=</span>urn:wmo:md:not-my-centre:synop-test<span class="w"> </span>not<span class="w"> </span>found<span class="w"> </span><span class="k">in</span><span class="w"> </span>data<span class="w"> </span>mappings
</code></pre></div>
<p>Le message d'erreur indique que l'identifiant de métadonnées que vous avez fourni ne correspond à aucun des ensembles de données que vous avez configurés dans votre instance wis2box.</p>
<p>Fournissez l'identifiant de métadonnées correct qui correspond à l'ensemble de données que vous avez créé lors de la session pratique précédente et répétez la commande d'ingestion des données jusqu'à ce que vous voyiez la sortie suivante :</p>
<div class="highlight"><pre><span></span><code>Processing<span class="w"> </span>/data/wis2box/data-ingest-exercises/synop_202412030900.txt
Done
</code></pre></div>
</details>
<p>Allez à la console MinIO dans votre navigateur et vérifiez si le fichier <code>synop_202412030900.txt</code> a été téléchargé dans le bucket <code>wis2box-incoming</code>. Vous devriez voir un nouveau répertoire avec le nom de l'ensemble de données que vous avez fourni dans l'option <code>--metadata-id</code>, et à l'intérieur de ce répertoire, vous trouverez le fichier <code>synop_202412030900.txt</code> :</p>
<p><img alt="minio-wis2box-incoming-dataset-folder" src="/../assets/img/minio-data-ingest-test-data.png" width="800"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>La commande <code>wis2box data ingest</code> a téléchargé le fichier dans le bucket <code>wis2box-incoming</code> sur MinIO dans un répertoire nommé d'après l'identifiant de métadonnées que vous avez fourni.</p>
</div>
<p>Allez au tableau de bord Grafana dans votre navigateur et vérifiez le statut de l'ingestion des données.</p>
<div class="admonition question">
<p class="admonition-title">Vérifiez le statut de l'ingestion des données sur Grafana</p>
<p>Allez au tableau de bord Grafana à <strong>http://your-host:3000</strong> et vérifiez le statut de l'ingestion des données dans votre navigateur.</p>
<p>Comment pouvez-vous voir si les données ont été ingérées et publiées avec succès ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Si vous avez ingéré les données avec succès, vous devriez voir ce qui suit :</p>
<p><img alt="grafana_data_ingest" src="/../assets/img/grafana_data-ingest-test.png" width="400">  </p>
<p>Si vous ne voyez pas cela, veuillez vérifier les messages d'AVERTISSEMENT ou d'ERREUR affichés en bas du tableau de bord et tenter de les résoudre.</p>
</details>
<div class="admonition question">
<p class="admonition-title">Vérifiez le courtier MQTT pour les notifications WIS2</p>
<p>Allez à MQTT Explorer et vérifiez si vous pouvez voir le message de notification WIS2 pour les données que vous venez d'ingérer.</p>
<p>Combien de notifications de données WIS2 ont été publiées par votre wis2box ?</p>
<p>Comment accédez-vous au contenu des données publiées ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Vous devriez voir 1 notification de données WIS2 publiée par votre wis2box.</p>
<p>Pour accéder au contenu des données publiées, vous pouvez développer la structure du sujet pour voir les différents niveaux du message jusqu'à atteindre le dernier niveau et examiner le contenu du message.</p>
<p>Le contenu du message comporte une section "links" avec une clé "rel" de "canonical" et une clé "href" avec l'URL pour télécharger les données. L'URL sera au format <code>http://YOUR-HOST/data/...</code>. </p>
<p>Notez que le format des données est BUFR, et vous aurez besoin d'un analyseur BUFR pour visualiser le contenu des données. Le format BUFR est un format binaire utilisé par les services météorologiques pour échanger des données. Les plugins de données à l'intérieur de wis2box ont transformé les données en BUFR avant de les publier.</p>
</details>
<p>Après avoir terminé cet exercice, quittez le conteneur <strong>wis2box-management</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="nb">exit</span>
</code></pre></div>
<h2 id="telechargement-de-donnees-a-laide-de-linterface-web-minio">Téléchargement de données à l'aide de l'interface web MinIO</h2>
<p>Dans les exercices précédents, vous avez téléchargé des données disponibles sur l'hôte wis2box sur MinIO en utilisant la commande <code>wis2box data ingest</code>. </p>
<p>Ensuite, nous utiliserons l'interface web MinIO, qui vous permet de télécharger et de télécharger des données sur MinIO à l'aide d'un navigateur web.</p>
<div class="admonition question">
<p class="admonition-title">Retéléchargez les données à l'aide de l'interface web MinIO</p>
<p>Allez à l'interface web MinIO dans votre navigateur et parcourez le bucket <code>wis2box-incoming</code>. Vous verrez le fichier <code>synop_202412030900.txt</code> que vous avez téléchargé lors des exercices précédents.</p>
<p>Cliquez sur le fichier, et vous aurez l'option de le télécharger :</p>
<p><img alt="minio-wis2box-incoming-dataset-folder" src="/../assets/img/minio-download.png" width="800"></p>
<p>Vous pouvez télécharger ce fichier et le retélécharger sur le même chemin dans MinIO pour redéclencher le flux de travail wis2box.</p>
<p>Vérifiez le tableau de bord Grafana et MQTT Explorer pour voir si les données ont été ingérées et publiées avec succès.</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Vous verrez un message indiquant que wis2box a déjà publié ces données :</p>
<div class="highlight"><pre><span></span><code>ERROR<span class="w"> </span>-<span class="w"> </span>Data<span class="w"> </span>already<span class="w"> </span>published<span class="w"> </span><span class="k">for</span><span class="w"> </span>WIGOS_0-20000-0-64400_20241203T090000-bufr4<span class="p">;</span><span class="w"> </span>not<span class="w"> </span>publishing
</code></pre></div>
<p>Cela démontre que le flux de travail des données a été déclenché, mais les données n'ont pas été republiées. Le wis2box ne publiera pas les mêmes données deux fois. </p>
</details>
<div class="admonition question">
<p class="admonition-title">Téléchargez de nouvelles données à l'aide de l'interface web MinIO</p>
<p>Téléchargez ce fichier d'échantillon <a href="../../../sample-data/synop_202502040900.txt">synop_202502040900.txt</a> (cliquez avec le bouton droit et sélectionnez "enregistrer sous" pour télécharger le fichier).</p>
<p>Téléchargez le fichier que vous avez téléchargé à l'aide de l'interface web sur le même chemin dans MinIO que le fichier précédent.</p>
<p>Les données ont-elles été ingérées et publiées avec succès ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Allez au tableau de bord Grafana et vérifiez si les données ont été ingérées et publiées avec succès.</p>
<p>Si vous utilisez le mauvais chemin, vous verrez un message d'erreur dans les journaux.</p>
<p>Si vous utilisez le bon chemin, vous verrez une notification de données WIS2 supplémentaire publiée pour la station de test <code>0-20000-0-64400</code>, indiquant que les données ont été ingérées et publiées avec succès.</p>
<p><img alt="grafana_data_ingest" src="/../assets/img/grafana_data-ingest-test2.png" width="400"> </p>
</details>
<h2 id="telechargement-de-donnees-a-laide-de-sftp">Téléchargement de données à l'aide de SFTP</h2>
<p>Le service MinIO dans wis2box peut également être accédé via SFTP. Le serveur SFTP pour MinIO est lié au port 8022 sur l'hôte (le port 22 est utilisé pour SSH).</p>
<p>Dans cet exercice, nous allons démontrer comment utiliser WinSCP pour télécharger des données sur MinIO à l'aide de SFTP.</p>
<p>Vous pouvez configurer une nouvelle connexion WinSCP comme le montre cette capture d'écran :</p>
<p><img alt="winscp-sftp-connection" src="/../assets/img/winscp-sftp-login.png" width="400"></p>
<p>Les identifiants pour la connexion SFTP sont définis par <code>WIS2BOX_STORAGE_USERNAME</code> et <code>WIS2BOX_STORAGE_PASSWORD</code> dans votre fichier <code>wis2box.env</code> et sont les mêmes que les identifiants que vous avez utilisés pour vous connecter à l'interface utilisateur de MinIO.</p>
<p>Lorsque vous vous connectez, vous verrez les buckets utilisés par wis2box dans MinIO :</p>
<p><img alt="winscp-sftp-bucket" src="/../assets/img/winscp-buckets.png" width="600"></p>
<p>Vous pouvez naviguer jusqu'au bucket <code>wis2box-incoming</code> puis jusqu'au dossier de votre ensemble de données. Vous verrez les fichiers que vous avez téléchargés lors des exercices précédents :</p>
<p><img alt="winscp-sftp-incoming-path" src="/../assets/img/winscp-incoming-data-path.png" width="600"></p>
<div class="admonition question">
<p class="admonition-title">Téléchargez des données à l'aide de SFTP</p>
<p>Téléchargez ce fichier d'échantillon sur votre ordinateur local :</p>
<p><a href="../../../sample-data/synop_202503030900.txt">synop_202503030900.txt</a> (cliquez avec le bouton droit et sélectionnez "enregistrer sous" pour télécharger le fichier).</p>
<p>Ensuite, téléchargez-le sur le chemin de l'ensemble de données entrant dans MinIO à l'aide de votre session SFTP dans WinSCP.</p>
<p>Vérifiez le tableau de bord Grafana et MQTT Explorer pour voir si les données ont été ingérées et publiées avec succès.</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Vous devriez voir une nouvelle notification de données WIS2 publiée pour la station de test <code>0-20000-0-64400</code>, indiquant que les données ont été ingérées et publiées avec succès.</p>
<p><img alt="grafana_data_ingest" src="/../assets/img/grafana_data-ingest-test3.png" width="400"></p>
</details>
<p>Si vous utilisez un chemin incorrect, vous verrez un message d'erreur dans les journaux.</p>
<h2 id="televersement-de-donnees-a-laide-dun-script-python">Téléversement de données à l'aide d'un script Python</h2>
<p>Dans cet exercice, nous utiliserons le client Python de MinIO pour copier des données dans MinIO.</p>
<p>MinIO fournit un client Python, qui peut être installé comme suit :</p>
<div class="highlight"><pre><span></span><code>pip3<span class="w"> </span>install<span class="w"> </span>minio
</code></pre></div>
<p>Sur votre VM étudiant, le package 'minio' pour Python sera déjà installé.</p>
<p>Dans le répertoire <code>exercise-materials/data-ingest-exercises</code>, vous trouverez un script exemple <code>copy_file_to_incoming.py</code> qui peut être utilisé pour copier des fichiers dans MinIO.</p>
<p>Essayez d'exécuter le script pour copier le fichier de données exemple <code>synop_202501030900.txt</code> dans le seau <code>wis2box-incoming</code> de MinIO comme suit :</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~/wis2box-data/data-ingest-exercises
python3<span class="w"> </span>copy_file_to_incoming.py<span class="w"> </span>synop_202501030900.txt
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Vous obtiendrez une erreur car le script n'est pas configuré pour accéder au point de terminaison MinIO sur votre wis2box.</p>
</div>
<p>Le script doit connaître le point de terminaison correct pour accéder à MinIO sur votre wis2box. Si wis2box est en cours d'exécution sur votre hôte, le point de terminaison MinIO est disponible à <code>http://YOUR-HOST:9000</code>. Le script doit également être mis à jour avec votre mot de passe de stockage et le chemin dans le seau MinIO pour stocker les données.</p>
<div class="admonition question">
<p class="admonition-title">Mettre à jour le script et ingérer les données CSV</p>
<p>Modifiez le script <code>copy_file_to_incoming.py</code> pour corriger les erreurs, en utilisant l'une des méthodes suivantes :
- Depuis la ligne de commande : utilisez l'éditeur de texte <code>nano</code> ou <code>vim</code> pour modifier le script.
- En utilisant WinSCP : démarrez une nouvelle connexion en utilisant le protocole de fichier <code>SCP</code> et les mêmes identifiants que votre client SSH. Naviguez dans le répertoire <code>wis2box-data/data-ingest-exercises</code> et modifiez <code>copy_file_to_incoming.py</code> en utilisant l'éditeur de texte intégré.</p>
<p>Assurez-vous de :</p>
<ul>
<li>Définir le point de terminaison MinIO correct pour votre hôte.</li>
<li>Fournir le mot de passe de stockage correct pour votre instance MinIO.</li>
<li>Fournir le chemin correct dans le seau MinIO pour stocker les données.</li>
</ul>
<p>Réexécutez le script pour ingérer le fichier de données exemple <code>synop_202501030900.txt</code> dans MinIO :</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>~/wis2box-data/<span class="w"> </span>~/wis2box-data/synop_202501030900.txt
</code></pre></div>
<p>Assurez-vous que les erreurs sont résolues.</p>
</div>
<p>Une fois que vous parvenez à exécuter le script avec succès, vous verrez un message indiquant que le fichier a été copié dans MinIO, et vous devriez voir des notifications de données publiées par votre instance wis2box dans MQTT Explorer.</p>
<p>Vous pouvez également vérifier le tableau de bord Grafana pour voir si les données ont été ingérées et publiées avec succès.</p>
<p>Maintenant que le script fonctionne, vous pouvez essayer de copier d'autres fichiers dans MinIO en utilisant le même script.</p>
<div class="admonition question">
<p class="admonition-title">Ingérer des données binaires au format BUFR</p>
<p>Exécutez la commande suivante pour copier le fichier de données binaires <code>bufr-example.bin</code> dans le seau <code>wis2box-incoming</code> de MinIO :</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>copy_file_to_incoming.py<span class="w"> </span>bufr-example.bin
</code></pre></div>
</div>
<p>Vérifiez le tableau de bord Grafana et MQTT Explorer pour voir si les données de test ont été ingérées et publiées avec succès. Si vous voyez des erreurs, essayez de les résoudre.</p>
<div class="admonition question">
<p class="admonition-title">Vérifier l'ingestion des données</p>
<p>Combien de messages ont été publiés au courtier MQTT pour cet échantillon de données ?</p>
</div>
<details class="success">
<summary>Cliquez pour révéler la réponse</summary>
<p>Vous verrez des erreurs signalées dans Grafana car les stations dans le fichier BUFR ne sont pas définies dans la liste des stations de votre instance wis2box.</p>
<p>Si toutes les stations utilisées dans le fichier BUFR sont définies dans votre instance wis2box, vous devriez voir 10 messages publiés au courtier MQTT. Chaque notification correspond à des données pour une station pour un horodatage d'observation.</p>
<p>Le plugin <code>wis2box.data.bufr4.ObservationDataBUFR</code> divise le fichier BUFR en messages BUFR individuels et publie un message pour chaque station et horodatage d'observation.</p>
</details>
<h2 id="conclusion">Conclusion</h2>
<div class="admonition success">
<p class="admonition-title">Félicitations !</p>
<p>Dans cette session pratique, vous avez appris à :</p>
<ul>
<li>Déclencher le flux de travail wis2box en téléversant des données dans MinIO en utilisant diverses méthodes.</li>
<li>Déboguer les erreurs courantes dans le processus d'ingestion de données en utilisant le tableau de bord Grafana et les journaux de votre instance wis2box.</li>
<li>Surveiller les notifications de données WIS2 publiées par votre wis2box dans le tableau de bord Grafana et MQTT Explorer.</li>
</ul>
</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 World Meteorological Organization
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../../../assets/js/disclaimer.js"></script>
      
    
  </body>
</html>